# Project Specification

## Overview

**LogScope** is a self-hosted structured log collection and query service for web applications. Users clone the repository, run it locally on their own device, and use it for development and debugging. It aggregates log events from both backend (Node/Express) and frontend (browser) environments into a unified queryable store.

**Purpose:** Enable developers to detect errors, explore root causes, recognize patterns, and analyze event sequences through correlated structured logging in a local, self-contained environment.

## Target Users

- **Primary:** Web developers debugging applications during local development
- **Secondary:** DevOps engineers testing log pipelines before production
- **Use Case:** Self-hosted tool that each developer runs on their own machine

## Functional Requirements

### Must Have ✅
- [x] Log collection from Node.js backend (runtime: "node")
- [x] Log collection from browser frontend (runtime: "browser")
- [x] Structured log format with timestamp, level, subject, message, source metadata
- [x] Correlation IDs (requestId, sessionId, userId)
- [x] File-based persistence (JSON files)
- [x] REST API for log ingestion (POST /api/logs/collect)
- [x] REST API for log search (GET /api/logs/search)
- [x] Time range filtering
- [x] Log level filtering (debug, info, warn, error, critical, success)
- [x] Subject/text search
- [x] Pagination (limit/offset)
- [x] Real-time log streaming via WebSocket
- [x] Web UI for viewing logs
- [x] Critical alert banner
- [x] Dark mode toggle
- [x] Rate limiting

### Should Have ✅
- [x] Star/pin logs to protect from deletion
- [x] Auto-cleanup (time-based and capacity-based)
- [x] Configurable cleanup settings via environment variables
- [x] Docker support for containerized deployment
- [x] OpenAPI specification
- [x] Configuration scripts (Linux/macOS/Windows)

### Could Have (Future)
- [ ] Log export (JSON, CSV)
- [ ] Log redaction for sensitive data
- [ ] Advanced search (regex, field-specific)
- [ ] Dashboard with aggregation charts

### Recently Completed
- [x] API key authentication for remote deployments

### Won't Have (This Version)
- Multi-user authentication
- Cloud deployment features
- Log shipping to external services
- Production monitoring features

## Non-Functional Requirements

- **Performance:** Handle thousands of logs without significant slowdown; in-memory index for fast queries
- **Security:** Input validation on all endpoints; rate limiting; designed for trusted local environment (no auth in v1)
- **Accessibility:** Web UI follows WCAG AA guidelines where applicable
- **Platform Support:** Node.js 18+, modern browsers (Chrome, Firefox, Safari, Edge)

## UI/UX Requirements

- **Framework:** React 19 with Bootstrap 5
- **Color Scheme:** Light/dark mode toggle with localStorage persistence
- **Layout:** Responsive sidebar (collapsible, resizable 200-450px)
- **Status Indicators:** 
  - Red pulse for critical alerts
  - Green pulse for "all systems operational"
- **Table Features:** Sortable columns, expandable rows for log details, star/pin column

## Data Model

### LogEntry
```typescript
{
  eventId: string;              // UUID, auto-generated by server
  timestamp: string;            // ISO 8601 UTC
  level: "debug" | "info" | "warn" | "error" | "critical" | "success";
  subject: string;              // categorical label (max 255 chars)
  message: string;              // log message (max 1024 chars)
  data?: unknown;               // optional structured data (max 10KB)
  starred?: boolean;            // pinned from auto-deletion
  source: {
    function: string;
    file: string;
    process: string;
    runtime: "node" | "browser";
    serviceName: string;
  };
  correlation: {
    requestId?: string;
    sessionId?: string;
    userId?: string;
  };
}
```

### Storage Structure
- `logs/backend.json` — Node.js logs (runtime: "node")
- `logs/frontend.json` — Browser logs (runtime: "browser")
- `logs/starred.json` — Set of starred eventIds

## External Integrations

None required. Self-contained application.

## Constraints & Assumptions

- **Local Development Focus:** Designed for single-user, local machine usage
- **File-Based Storage:** No database; uses JSON files (suitable for development volumes)
- **No Authentication:** Trusted environment; user runs their own instance
- **Bounded Queries:** Pagination and limits prevent unbounded responses
- **Memory Constraints:** In-memory index; clears on restart
